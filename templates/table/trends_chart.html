{% load static %}

<a href="{{ record.traces_url }}">
    <canvas id="{{ record.id }}-trends" class="m-2 max-w-20 max-h-20"></canvas>
</a>
<script>
  document.addEventListener("htmx:afterSettle", (e) => {
    const canvasElement = document.getElementById('{{ record.id }}-trends');
    if (canvasElement.chart) {
        // Destroy existing chart if it exists
        canvasElement.chart.destroy();
    }

    const chartContext = canvasElement.getContext('2d');
    // Store chart reference on canvas for future cleanup
    canvasElement.chart = SiteJS.trends.trendsChart(chartContext, "{% url 'experiments:trends_data' record.team.slug record.id %}");
  });
</script>
