{% extends "mfa/mfa_base.html" %}
{% load form_tags i18n %}

{% block app %}
  <section class="app-card">
    <h2 class="pg-title">{% translate "Setup Two-Factor Authentication" %}</h2>

    <h3 class="pg-subtitle"><strong>{% translate "Step 1" %}:</strong></h3>
    <p>
      {% blocktranslate %}
      Scan the QR code below with a token generator of your choice
      (e.g. <a href="https://support.google.com/accounts/answer/1066447" target="_blank" rel="noopener noreferrer">Google Authenticator</a>).
      {% endblocktranslate %}
    </p>

    <div class="mb-4 p-4 bg-white inline-block">
      {{ totp_svg|safe }}
    </div>

    <h3 class="pg-subtitle"><strong>{% translate "Step 2" %}:</strong></h3>
    <p>{% translate "Or manually enter this secret:" %}</p>
    <p class="font-mono text-lg mb-4">{{ authenticator.wrap.secret }}</p>

    <h3 class="pg-subtitle"><strong>{% translate "Step 3" %}:</strong></h3>
    <p>{% translate "Input a token generated by the app:" %}</p>

    <form method="post" action="{% url 'mfa_activate_totp' %}" class="mt-3">
      {% csrf_token %}
      {{ form.non_field_errors }}
      {% render_form_fields form %}
      <div class="mt-2">
        <button type="submit" class="btn btn-primary">
          {% translate "Activate" %}
        </button>
      </div>
    </form>
  </section>
{% endblock app %}
